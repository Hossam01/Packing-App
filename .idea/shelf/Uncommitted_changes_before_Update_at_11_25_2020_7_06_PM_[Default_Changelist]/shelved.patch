Index: app/src/main/java/com/example/packingapp/UI/AssignPackedOrderForZoneAndDriverActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.packingapp.UI;\r\n\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.lifecycle.Observer;\r\nimport androidx.lifecycle.ViewModelProviders;\r\n\r\nimport android.app.AlertDialog;\r\nimport android.content.Context;\r\nimport android.content.DialogInterface;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.AdapterView;\r\nimport android.widget.ArrayAdapter;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.packingapp.Database.AppDatabase;\r\nimport com.example.packingapp.R;\r\nimport com.example.packingapp.databinding.ActivityAssignPackedOrderForZoneDriverBinding;\r\nimport com.example.packingapp.model.RecievePacked.RecievePackedModule;\r\nimport com.example.packingapp.model.ResponseDriver;\r\nimport com.example.packingapp.model.ResponseUpdateStatus;\r\nimport com.example.packingapp.viewmodel.AssignPackedOrderToZoneViewModel;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\npublic class AssignPackedOrderForZoneAndDriverActivity extends AppCompatActivity {\r\n    private static final String TAG = \"AssignPackedOrderForZon\";\r\nActivityAssignPackedOrderForZoneDriverBinding binding;\r\n    AssignPackedOrderToZoneViewModel assignPackedOrderToZoneViewModel;\r\n    AppDatabase database;\r\n    final Context context = this;\r\n    String Zone ,trackingnumberIn;\r\n    ArrayList<String> Drivers_IDs_list ;\r\n    ResponseDriver responseDriver;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        binding= ActivityAssignPackedOrderForZoneDriverBinding.inflate(getLayoutInflater());\r\n        setContentView(binding.getRoot());\r\n        database=AppDatabase.getDatabaseInstance(this);\r\n\r\n        assignPackedOrderToZoneViewModel= ViewModelProviders.of(this).get(AssignPackedOrderToZoneViewModel.class);\r\n\r\n        GETDriverID();\r\n\r\n       ControlLayout();\r\n\r\n       ButtonsClickListnerForAssignToZone();\r\n        \r\n    }\r\n\r\n    private void ButtonsClickListnerForAssignToZone() {\r\n        binding.btnLoadingNewPurchaseOrderZone.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                if (!binding.editTrackingnumberZone.getText().toString().isEmpty() &&\r\n                        !binding.editZone.getText().toString().isEmpty()) {\r\n                    LoadNewPurchaseOrderBTN_Zone();\r\n                }else {\r\n                    if (binding.editTrackingnumberZone.getText().toString().isEmpty()) {\r\n                        binding.editTrackingnumberZone.setError(\"أدخل السريال\");\r\n                        binding.editTrackingnumberZone.requestFocus();\r\n                    }else if (binding.editZone.getText().toString().isEmpty()){\r\n                        binding.editZone.setError(\"أدخل المنطقه\");\r\n                        binding.editZone.requestFocus();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n\r\n        binding.btnUpdateOrderStatusZone.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                List<RecievePackedModule>  recievePackedORDER_NO_Distinctlist=  database.userDao().getRecievePacked_ORDER_NO_Distinct();\r\n                List<RecievePackedModule>  NOTrecievedPackedORDERlist=  new ArrayList<>();\r\n                if (recievePackedORDER_NO_Distinctlist.size()>0) {\r\n                    for (int i = 0; i>recievePackedORDER_NO_Distinctlist.size();i++){\r\n                        List<String>  recievePacked_Tracking_Number_countlist=\r\n                                database.userDao().getRecievePacked_Tracking_Number_count(recievePackedORDER_NO_Distinctlist.get(i).getORDER_NO());\r\n                        if (!recievePacked_Tracking_Number_countlist.get(i).\r\n                                equalsIgnoreCase(recievePackedORDER_NO_Distinctlist.get(i).getNO_OF_PACKAGES().toString())){\r\n                            NOTrecievedPackedORDERlist.add(recievePackedORDER_NO_Distinctlist.get(i));\r\n                        }\r\n                    }\r\n\r\n                    if (NOTrecievedPackedORDERlist.size()==0){\r\n                        //TODO UPDATE STATUS\r\n                        // Toast.makeText(RecievePackedOrderForSortingActivity.this, String.format(\"%s\",getString(R.string.message_equalfornoofpaclkageandcountoftrackingnumbers)), Toast.LENGTH_SHORT).show();\r\n                        UpdateStatus_ON_83(\"in sorting\");\r\n                        UpdateStatus(\"in sorting\");\r\n                    }else {\r\n                        Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, String.format(\"%s\",\r\n                                getString(R.string.message_not_equalfornoofpaclkageandcountoftrackingnumbers)), Toast.LENGTH_SHORT).show();\r\n                    }\r\n                }else {\r\n                    Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, String.format(\"%s\",\r\n                            getString(R.string.there_is_no_trackednumber_scanned)), Toast.LENGTH_SHORT).show();\r\n                }\r\n            }\r\n        });\r\n\r\n        binding.btnDeleteLastTrackingnumbersZone.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                List<RecievePackedModule>  recievePackedORDER_NO_Distinctlist=  database.userDao().getRecievePacked_ORDER_NO_Distinct();\r\n                if (recievePackedORDER_NO_Distinctlist.size()>0) {\r\n                    new AlertDialog.Builder(AssignPackedOrderForZoneAndDriverActivity.this)\r\n                            .setTitle(getString(R.string.delete_dialoge))\r\n                            .setPositiveButton(\"موافق\", new DialogInterface.OnClickListener() {\r\n                                public void onClick(DialogInterface dialog, int whichButton) {\r\n                                    database.userDao().deleteRecievePackedModule();\r\n                                    binding.editTrackingnumberZone.setError(null);\r\n                                    binding.editZone.setError(null);\r\n                                    binding.editZone.setText(\"\");\r\n                                }\r\n                            })\r\n                            .setNegativeButton(\"إلغاء\", new DialogInterface.OnClickListener() {\r\n                                public void onClick(DialogInterface dialog, int whichButton) {\r\n                                    dialog.cancel();\r\n                                }\r\n                            }).show();\r\n                }else {\r\n                    Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"لايوجد بيانات للحذف\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            }\r\n        });\r\n\r\n        binding.btnAssignOrdersToZone.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                if (binding.editTrackingnumberZone.getText().toString().isEmpty()\r\n                        && binding.editZone.getText().toString().isEmpty()) {\r\n                    UpdateStatus(\"sorted\");\r\n                    UpdateStatus_ON_83(\"sorted\");\r\n                }else{\r\n                    if (binding.editTrackingnumberZone.getText().toString().isEmpty()){\r\n                        binding.editTrackingnumberZone.setError(\"Enter tracking number\");\r\n                    }else if (binding.editZone.getText().toString().isEmpty())\r\n                        binding.editZone.setError(\"enter zone\");\r\n\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private void ControlLayout() {\r\n        binding.btnShowAssignOrdersToZone.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                if (binding.linearAssignOrderToZone.getVisibility() == View.GONE) {\r\n                    binding.linearAssignOrderToZone.setVisibility(View.VISIBLE);\r\n                    binding.linearAssignOrderToDriver.setVisibility(View.GONE);\r\n                }else if (binding.linearAssignOrderToZone.getVisibility() == View.VISIBLE){\r\n                    binding.linearAssignOrderToZone.setVisibility(View.GONE);\r\n                    binding.linearAssignOrderToDriver.setVisibility(View.GONE);\r\n                }\r\n            }\r\n        });\r\n\r\n        binding.btnShowAssignOrdersToDriver.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n\r\n                if (binding.linearAssignOrderToDriver.getVisibility() == View.GONE) {\r\n                    binding.linearAssignOrderToZone.setVisibility(View.GONE);\r\n                    binding.linearAssignOrderToDriver.setVisibility(View.VISIBLE);\r\n                }else if (binding.linearAssignOrderToDriver.getVisibility() == View.VISIBLE){\r\n                    binding.linearAssignOrderToZone.setVisibility(View.GONE);\r\n                    binding.linearAssignOrderToDriver.setVisibility(View.GONE);\r\n                }\r\n\r\n\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n\r\n    private void LoadNewPurchaseOrderBTN_Zone() {\r\n        String OrderNumber;\r\n        if (\r\n                //!binding.editTrackingnumberZone.getText().toString().isEmpty() &&\r\n                binding.editTrackingnumberZone.getText().toString().contains(\"-\")) {\r\n            OrderNumber=\r\n                    binding.editTrackingnumberZone.getText().toString().substring(0,\r\n                            binding.editTrackingnumberZone.getText().toString().indexOf(\"-\"));\r\n\r\n            List<RecievePackedModule> recievePackedlist=  database.userDao().getRecievePacked_ORDER_NO(OrderNumber);\r\n            if (recievePackedlist.size() == 0){\r\n                binding.editTrackingnumberZone.setError(null);\r\n\r\n                GETOrderData(binding.editTrackingnumberZone.getText().toString());\r\n                AssignToZone(binding.editTrackingnumberZone.getText().toString()\r\n                        ,binding.editZone.getText().toString());\r\n                Log.e(TAG, \"onClick: Ord \"+OrderNumber );\r\n            //    Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"تم\", Toast.LENGTH_SHORT).show();\r\n            }else if (database.userDao().getRecievePacked_Tracking_Number(binding.editTrackingnumberZone.getText().toString())\r\n                    .size() ==0){\r\n                binding.editTrackingnumberZone.setError(null);\r\n\r\n                GETOrderData(binding.editTrackingnumberZone.getText().toString());\r\n                Log.e(TAG, \"onClick: Trac \"+binding.editTrackingnumberZone.getText().toString() );\r\n            //    Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"تم\", Toast.LENGTH_SHORT).show();\r\n                AssignToZone(binding.editTrackingnumberZone.getText().toString()\r\n                        ,binding.editZone.getText().toString());\r\n            }else {\r\n                binding.editTrackingnumberZone.setError(\"تم أدخال هذا من قبل \");\r\n                binding.editTrackingnumberZone.setText(\"\");\r\n                binding.editZone.setText(\"\");\r\n                binding.editTrackingnumberZone.requestFocus();\r\n            }\r\n        }else {\r\n\r\n            binding.editTrackingnumberZone.setError(getString(R.string.enter_valid_tracking_number));\r\n            binding.editTrackingnumberZone.setText(\"\");\r\n            binding.editZone.setText(\"\");\r\n            binding.editTrackingnumberZone.requestFocus();\r\n\r\n        }\r\n\r\n    }\r\n\r\n   private void AssignToZone(String trackingnumber1 ,String Zone1 ){\r\n        String OrderNumber=\r\n                trackingnumber1.substring(0,\r\n                        trackingnumber1.indexOf(\"-\"));\r\n\r\n        List<RecievePackedModule>  recievePackedlist =  database.userDao().getRecievePacked_ORDER_NO(OrderNumber);\r\n        if (recievePackedlist.size() == 0) {\r\n            GETOrderData(trackingnumber1);\r\n            AssignToZone(trackingnumber1,Zone1);\r\n            Toast.makeText(context, \"تم\", Toast.LENGTH_SHORT).show();\r\n        }else if (recievePackedlist.size() >= 0){\r\n            if (recievePackedlist.get(0).getZone().isEmpty()) {\r\n                database.userDao().UpdatezoneForORDER_NO(OrderNumber,Zone1);\r\n                Toast.makeText(context, \"تم\", Toast.LENGTH_SHORT).show();\r\n            }else if (!recievePackedlist.get(0).getZone().isEmpty()){\r\n                new AlertDialog.Builder(AssignPackedOrderForZoneAndDriverActivity.this)\r\n                        .setTitle(getString(R.string.updte_zone_if_exist))\r\n                        .setPositiveButton(\"موافق\", new DialogInterface.OnClickListener() {\r\n                            public void onClick(DialogInterface dialog, int whichButton) {\r\n                                database.userDao().UpdatezoneForORDER_NO(OrderNumber,Zone1);\r\n                                Toast.makeText(context, \"تم\", Toast.LENGTH_SHORT).show();\r\n                            }\r\n                        })\r\n                        .setNegativeButton(\"إلغاء\", new DialogInterface.OnClickListener() {\r\n                            public void onClick(DialogInterface dialog, int whichButton) {\r\n                                dialog.cancel();\r\n                            }\r\n                        }).show();\r\n            }\r\n        }\r\n    }\r\n\r\n    private void GETOrderData(String trackingnumber ){\r\n        assignPackedOrderToZoneViewModel.fetchdata(trackingnumber);\r\n        assignPackedOrderToZoneViewModel.getOrderDataLiveData().observe(AssignPackedOrderForZoneAndDriverActivity.this, new Observer<RecievePackedModule>() {\r\n            @Override\r\n            public void onChanged(RecievePackedModule responseGetOrderData) {\r\n                    Log.e(TAG, \"onChanged: \" + responseGetOrderData.getNO_OF_PACKAGES());\r\n\r\n                    database.userDao().insertRecievePacked(new RecievePackedModule(\r\n                            responseGetOrderData.getORDER_NO(), responseGetOrderData.getNO_OF_PACKAGES(),\r\n                            trackingnumber));\r\n                    binding.editTrackingnumberZone.setText(\"\");\r\n                    binding.editTrackingnumberZone.setError(null);\r\n                    binding.editZone.setText(\"\");\r\n                    binding.editZone.setError(null);\r\n                    Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"تم\", Toast.LENGTH_SHORT).show();\r\n\r\n                    Log.e(TAG, \"onChanged: insertR\" + trackingnumber);\r\n\r\n            }\r\n\r\n        });\r\n\r\n        assignPackedOrderToZoneViewModel.mutableLiveDataError.observe(this, new Observer<String>() {\r\n            @Override\r\n            public void onChanged(String s) {\r\n                Log.e(TAG, \"onChanged: \"+s );\r\n\r\n                if (s.equals(\"HTTP 503 Service Unavailable\")) {\r\n                      Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"السريال غير موجود على السرفير\", Toast.LENGTH_SHORT).show();\r\n                }else {\r\n                    Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, s, Toast.LENGTH_LONG).show();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private void LoadNewPurchaseOrderBTN_Driver() {\r\n        String OrderNumber;\r\n        if (!binding.editTrackingnumberDriver.getText().toString().isEmpty() &&\r\n                binding.editTrackingnumberDriver.getText().toString().contains(\"-\")) {\r\n            OrderNumber=\r\n                    binding.editTrackingnumberDriver.getText().toString().substring(0,\r\n                            binding.editTrackingnumberDriver.getText().toString().indexOf(\"-\"));\r\n\r\n            List<RecievePackedModule> recievePackedlist=  database.userDao().getRecievePacked_ORDER_NO(OrderNumber);\r\n            if (recievePackedlist.size() == 0){\r\n                binding.editTrackingnumberDriver.setError(null);\r\n\r\n                GETOrderData(binding.editTrackingnumberDriver.getText().toString());\r\n                Log.e(TAG, \"onClick: Ord \"+OrderNumber );\r\n                Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"تم\", Toast.LENGTH_SHORT).show();\r\n            }else if (database.userDao().getRecievePacked_Tracking_Number(binding.editTrackingnumberDriver.getText().toString())\r\n                    .size() ==0){\r\n                binding.editTrackingnumberDriver.setError(null);\r\n\r\n                GETOrderData(binding.editTrackingnumberDriver.getText().toString());\r\n                Log.e(TAG, \"onClick: Trac \"+binding.editTrackingnumberDriver.getText().toString() );\r\n                Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"تم\", Toast.LENGTH_SHORT).show();\r\n            }else {\r\n                binding.editTrackingnumberDriver.setError(\"تم أدخال هذا من قبل \");\r\n                binding.editTrackingnumberDriver.setText(\"\");\r\n                binding.editTrackingnumberDriver.requestFocus();\r\n            }\r\n        }else {\r\n\r\n            binding.editTrackingnumberDriver.setError(getString(R.string.enter_tracking_number));\r\n            binding.editTrackingnumberDriver.setText(\"\");\r\n            binding.editTrackingnumberDriver.requestFocus();\r\n\r\n        }\r\n\r\n    }\r\n\r\n    public void UpdateStatus_ON_83(String Status){\r\n//        if (database.userDao().getAllItemsWithoutTrackingnumber().size() == 0){\r\n        List<RecievePackedModule> orderDataModuleDBHeaderkist = database.userDao().getorderNORecievePackedModule();\r\n        if (orderDataModuleDBHeaderkist.size() > 0) {\r\n            assignPackedOrderToZoneViewModel.UpdateStatus_ON_83(\r\n                    orderDataModuleDBHeaderkist.get(0).getORDER_NO(),\r\n                    Status\r\n            );\r\n        }else {\r\n            Toast.makeText(context, \"لم يتم أدخال \", Toast.LENGTH_SHORT).show();\r\n        }\r\n        assignPackedOrderToZoneViewModel.mutableLiveData_UpdateStatus_ON_83.observe(AssignPackedOrderForZoneAndDriverActivity.this, new Observer<ResponseUpdateStatus>() {\r\n            @Override\r\n            public void onChanged(ResponseUpdateStatus message) {\r\n                Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"\"+message.getMessage(), Toast.LENGTH_SHORT).show();\r\n                Log.e(TAG, \"onChanged:update \"+message.getMessage() );\r\n            }\r\n        });\r\n//        }else {\r\n//            Toast.makeText(GetOrderDatactivity.this, \"توجد عناصر لم يتم تعبئتها\", Toast.LENGTH_SHORT).show();\r\n//        }\r\n    }\r\n\r\n    public void UpdateStatus(String Status){\r\n//        if (database.userDao().getAllItemsWithoutTrackingnumber().size() == 0){\r\n\r\n        List<RecievePackedModule> orderDataModuleDBHeaderkist = database.userDao().getorderNORecievePackedModule();\r\n\r\n        assignPackedOrderToZoneViewModel.UpdateStatus(\r\n                orderDataModuleDBHeaderkist.get(0).getORDER_NO(),\r\n                Status\r\n        );\r\n        assignPackedOrderToZoneViewModel.mutableLiveData_UpdateStatus.observe(AssignPackedOrderForZoneAndDriverActivity.this, new Observer<ResponseUpdateStatus>() {\r\n            @Override\r\n            public void onChanged(ResponseUpdateStatus message) {\r\n                Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, \"\"+message.getMessage(), Toast.LENGTH_SHORT).show();\r\n                Log.e(TAG, \"onChanged:UpdateStatus \"+message.getMessage() );\r\n            }\r\n        });\r\n        assignPackedOrderToZoneViewModel.mutableLiveDataError.observe(this, new Observer<String>() {\r\n            @Override\r\n            public void onChanged(String s) {\r\n                Log.e(TAG, \"onChanged: \"+s );\r\n                Toast.makeText(AssignPackedOrderForZoneAndDriverActivity.this, s, Toast.LENGTH_LONG).show();\r\n            }\r\n        });\r\n\r\n\r\n    }\r\n\r\n    private void GETDriverID() {\r\n        Drivers_IDs_list =new ArrayList<>();\r\n        assignPackedOrderToZoneViewModel.GetDriversID();\r\n        //TODO TO ASSIGN ID TO SPINNER\r\n        ArrayAdapter<String> spinnerAdapterDriver=new ArrayAdapter<String>(AssignPackedOrderForZoneAndDriverActivity.this,\r\n                android.R.layout.simple_spinner_item,Drivers_IDs_list);\r\n        spinnerAdapterDriver.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);\r\n        binding.spinerDriverId.setAdapter(spinnerAdapterDriver);\r\n\r\n        assignPackedOrderToZoneViewModel.mutableLiveDataRead.observe(AssignPackedOrderForZoneAndDriverActivity.this\r\n                , (ResponseDriver responseDriver) -> {\r\n                    if (Drivers_IDs_list.size() == 0) {\r\n                        for (int i = 0; i < responseDriver.getRecords().size(); i++) {\r\n                            if (i == 0)\r\n                                Drivers_IDs_list.add(\"Select ID Driver\");\r\n                            Drivers_IDs_list.add(responseDriver.getRecords().get(i).getDriverID());\r\n                        }\r\n                    }\r\n                    this.responseDriver = responseDriver;\r\n                    spinnerAdapterDriver.notifyDataSetChanged();\r\n\r\n                });\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/example/packingapp/UI/AssignPackedOrderForZoneAndDriverActivity.java	(revision 5da2f63e1e71467cc9a176f137a11d691b42bfc0)
+++ app/src/main/java/com/example/packingapp/UI/AssignPackedOrderForZoneAndDriverActivity.java	(date 1606323982807)
@@ -235,8 +235,7 @@
 
         List<RecievePackedModule>  recievePackedlist =  database.userDao().getRecievePacked_ORDER_NO(OrderNumber);
         if (recievePackedlist.size() == 0) {
-            GETOrderData(trackingnumber1);
-            AssignToZone(trackingnumber1,Zone1);
+            GETOrderData(trackingnumber1,Zone1);
             Toast.makeText(context, "تم", Toast.LENGTH_SHORT).show();
         }else if (recievePackedlist.size() >= 0){
             if (recievePackedlist.get(0).getZone().isEmpty()) {
